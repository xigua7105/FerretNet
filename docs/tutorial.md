<div align="center">
<h2>üîéImplementation Details</h2>
</div>

## üíø Datasets
### üí° We expect the directory structure to be the following:

-
  ```
  path/to/dataset/
  |---Synthetic-Pop/
  |   |---SDXL-turbo/
  |   |   |---0_real
  |   |   |---1_fake
  |   | ...
  |   |---RealVisXL-4_0/
  |       |---0_real
  |       |---1_fake
  |--- ...
  |---ForenSynths/
      |---progan/
      |   |---airplane/
      |   |   |---0_real
      |   |   |---1_fake   
      |   |--- ...
      |   |---tvmonitor/
      |       |---0_real
      |       |---1_fake
      |--- ...
      |---stargan/
          |---0_real
          |---1_fake
  ```


### üî• Train data
- **ProGan-4cls**
  - üìÑ It includes 4 categories: car, cat, chair and horse, each category comprises 18,000 synthetic images generated by [ProGAN](https://arxiv.org/abs/1809.11096) and the same number of real images from [LSUN](https://link.springer.com/article/10.1007/s11263-015-0816-y), provided by [CNNDetection](https://arxiv.org/abs/1912.11035).
  - ‚¨áÔ∏è Download it from [original source](https://github.com/PeterWang512/CNNDetection#3-dataset) or our [Baidu Disk link](https://pan.baidu.com/s/1T55xEzkeWU6G7trIuiPAXw?pwd=A123).


### ‚ùÑÔ∏è Test data
- **ForenSynths** 
  - üìÑ The synthetic images are generated by eight representative models: ProGAN, StyleGAN, StyleGAN2, BigGAN, CycleGAN, StarGAN, GauGAN and Deepfake.
  - üö® During the training of the network, we use it to evaluate the model to obtain the best weights.
  - ‚¨áÔ∏è Download it from the [original source](https://github.com/PeterWang512/CNNDetection#3-dataset) or via the [Baidu Disk link](https://pan.baidu.com/s/1sozlYGb78AhX4vT1R0X7Xg?pwd=A123) we provide.


- **Diffusion-6-cls**:
  - üìÑ [FatFormer](https://arxiv.org/abs/2312.16649) collects six categories of DM-synthetic images from [DIRE](https://arxiv.org/abs/2303.09295) and [UniversalFakeDetect](https://arxiv.org/abs/2302.10174): PNDM, Guided, DALL-E, VQ-Diffusion, LDM, and Glide.
  - ‚¨áÔ∏è The original dataset links: [DIRE](https://github.com/ZhendongWang6/DIRE#diffusionforensics-dataset) and [UniversalFakeDetect](https://github.com/Yuheng-Li/UniversalFakeDetect#data).
  - ‚¨áÔ∏è Download it from [link 1](https://pan.baidu.com/s/1zoubPr5n_mGI27En9uyL8Q?pwd=a6sw) or [link 2](https://1drv.ms/u/s!Aqkrc9gPuk8jqaM1LAthli7KdRhr2A?e=ebbG9r) provided by [FatFormer](https://arxiv.org/abs/2312.16649), or via our [Baidu Disk link](https://pan.baidu.com/s/1u6oNu6AJmMf3ya-vfeDnaQ?pwd=A123).


- **Synthetic-Pop** 
  - üìÑ To align with the latest advance ments in high-quality and high-resolution image generation, We generated it using six popular models in ü§óhuggingface: [Openjourney](https://huggingface.co/prompthero/openjourney), [Proteus-0.3](https://huggingface.co/dataautogpt3/ProteusV0.3), [RealVisXL-4.0](https://huggingface.co/SG161222/RealVisXL_V4.0), [SD-3.5-Medium](https://huggingface.co/stabilityai/stable-diffusion-3.5-medium), [SDXL-Turbo](https://huggingface.co/stabilityai/sdxl-turbo) and [YiffyMix](https://huggingface.co/Yntec/YiffyMix)--each using the prompts of 5,000 captions from the [COCO](https://cocodataset.org/). Real images were randomly sampled from [COCO](https://cocodataset.org/) and [LAION-Aesthetics V2 (6.5+)](https://laion.ai/blog/laion-aesthetics/).
  - ‚¨áÔ∏è Download it from our [Baidu Disk link](https://pan.baidu.com/s/1hMkYkTE5CoJMtOewLHZEnA?pwd=A123).


- **Synthetic-Aesthetic** 
  - üìÑ 40,000 synthetic images from the [Simulacra Aesthetic Captions (SAC) dataset](https://github.com/JD-P/simulacra-aesthetic-captions), generated by different diffusion models based on prompts from over 40,000 real users, and the same number of real images from the [LAION-Aesthetics V2 (6.5+)](https://laion.ai/blog/laion-aesthetics/).
  - ‚¨áÔ∏è Download it from our [Baidu Disk link](https://pan.baidu.com/s/1rsNG8lAaUr8mzwH2FaMtmQ?pwd=A123).


## ‚úÖ More Details

- 
  | Optimizer | LR   | Betas          | Weight Decay | Batch Size | Epoch |
  |-----------|------|----------------|--------------|------------|-------|
  | Adam      | 2e-4 | (0.937, 0.999) | 5e-4         | 32         | 100   |



## üöÄ QuickStart

- Train from scratch with ProGAN-4cls. 
  ```
  python run.py --cfg_path configs/Train.yaml --mode train
  ```

- Evaluate on Diffusion-6-class, Pop-Synthetic-HQ, Synthetic-Aesthetic, etc. (The test_set_dir in [Test.yaml](../configs/Test.yaml) needs to be changed.)
  ```
  python run.py --cfg_path configs/Test.yaml --mode test
  ```